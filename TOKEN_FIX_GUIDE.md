# ๐ ุฏููู ุฅุตูุงุญ ูุดุงูู ุงูุชููู ูุงูุฌูุณุงุช

## ุงููุดููุฉ ุงูุฃุตููุฉ
```
โ ูุดูุช ุนูููุฉ ุชุฌุฏูุฏ ุงูุฌูุณุฉุ ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู
```
ุงูุณุจุจ: ุฌูุณุฉ ุงููุณุชุฎุฏู ุชูุชูู ูุงูุชููู ูุตูุฑ ูุฏูู

## ุงูุญู ุงููุทุจู

### 1. **ุชุญุณูู Axios Interceptor** (`lib/axios.js`)
โ **ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ:**
- ูุญุงููุฉ ูุณุงุฑุงุช ูุชุนุฏุฏุฉ ููุชุญุฏูุซ (`/users/refresh-token` ู `/users/refresh`)
- ูุนุงูุฌุฉ ุฃูุถู ูู refresh token ูู localStorage
- ุชุญุฏูุซ Headers ุจุนุฏ ุงูุชุญุฏูุซ ุงููุงุฌุญ
- ุฅุนุงุฏุฉ ูุญุงููุฉ ุงูุทูุจ ุงูุฃุตูู ุชููุงุฆูุงู
- ุชุณุฌูู ุชูุตููู ููุฃุฎุทุงุก ูู Console

### 2. **ุฃุฏุงุฉ ุชุตุญูุญ ุงูุฃุฎุทุงุก** (`lib/auth-debug.js`)
โ **ุงููุธุงุฆู:**
```javascript
window.authDebug.showTokenInfo()     // ุนุฑุถ ูุนูููุงุช ุงูุชููู
window.authDebug.expireToken()       // ุชุนุทูู ุงูุชููู ููุงุฎุชุจุงุฑ
window.authDebug.clearAllData()      // ุญุฐู ุฌููุน ุงูุจูุงูุงุช
```

ุงุณุชุฎุฏุงู: ุงูุชุญ Console (F12) ูุงูุชุจ ุงูุฃูุงูุฑ ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู

### 3. **ูุนุงูุฌ ุฃุฎุทุงุก ุงููุตุงุฏูุฉ** (`lib/auth-helper.js`)
โ **ุงูุฏูุงู ุงููุชุงุญุฉ:**
```javascript
handleAuthError(error, context)  // ูุนุงูุฌุฉ ุฃุฎุทุงุก 401, 403, 500
isValidSession()                 // ุงูุชุญูู ูู ุตุญุฉ ุงูุฌูุณุฉ
getToken()                       // ุงูุญุตูู ุนูู ุงูุชููู ุงูุญุงูู
getCurrentUser()                 // ุจูุงูุงุช ุงููุณุชุฎุฏู ุงูุญุงูู
```

### 4. **ุตูุญุฉ ุงุฎุชุจุงุฑ ุงูุชููู** (`app/token-debug/page.js`)
โ **ุงููุตูู:** http://localhost:3000/token-debug

**ุงูููุฒุงุช:**
- ุนุฑุถ ูุนูููุงุช ุงูุชููู ุงูุญุงููุฉ
- ูุญุงูุงุฉ ุงูุชูุงุก ุงูุฌูุณุฉ
- ุงุฎุชุจุงุฑ ุงูุชุญุฏูุซ ุงูุชููุงุฆู
- ุงุฎุชุจุงุฑ API ูุญูู
- ุญุฐู ุงูุจูุงูุงุช ุจุฃูุงู

### 5. **ุชุญุณููุงุช ุตูุญุฉ Contact**
โ **ุชุญุณููุงุช:**
- ุงูุชุญูู ูู ุตุญุฉ ุงูุฌูุณุฉ ูุจู ุงูุฅุฑุณุงู
- ุชูุฌูู ูุจุงุดุฑ ูููุฌู ุฅุฐุง ูู ููู ูุณุฌู ุฏุฎูู
- ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก

## ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุงูุชุญุฏูุซ ุงูุชููุงุฆู:
1. ุณุฌู ุงูุฏุฎูู
2. ุงูุชูู ุฅูู `/token-debug`
3. ุงุถุบุท "ุชุนุทูู ุงูุชููู (ููุงุฎุชุจุงุฑ)"
4. ุงุถุบุท "ุงุฎุชุจุงุฑ API ูุญูู"
5. ูุฌุจ ุฃู ูุญุฏุซ ุงูุชููู ุชููุงุฆูุงู

### ุงุฎุชุจุงุฑ Contact Form:
1. ุณุฌู ุงูุฏุฎูู
2. ุงูุชูู ุฅูู `/contact`
3. ููุก ุงูุญููู ูุฅุฑุณุงู ุงูุฑุณุงูุฉ
4. ูุฌุจ ุฃู ุชุธูุฑ ุฑุณุงูุฉ ูุฌุงุญ

## ุงููุดุงูู ุงููุชููุนุฉ ูุงูุญููู

### ุงููุดููุฉ: "No refresh token available"
**ุงูุญู:** ุชุฃูุฏ ูู ุฃู ุงูุจูุงู ุฅูุฏ ูุฑุณู `refreshToken` ูุน `accessToken` ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู

### ุงููุดููุฉ: "No token in refresh response"
**ุงูุญู:** ุชุฃูุฏ ูู ุฃู endpoint ุงูุชุญุฏูุซ ูุฑุณู `accessToken` ุฃู `token`

### ุงููุดููุฉ: ุฎุทุฃ 500 ูู Contact
**ุงูุญู:** ูู ุจุชุดุบูู migration ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```bash
cd backend
npx prisma migrate dev --name add_contact_message
```

## ุงูุจููุฉ ุงููุชููุนุฉ ููู Tokens

### ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู (`/users/login`)
**ุงูุฑุฏ:**
```json
{
  "id": "user_id",
  "email": "user@example.com",
  "name": "User Name",
  "accessToken": "eyJhbGci...",
  "refreshToken": "eyJhbGci...",
  "role": "user"
}
```

### ุนูุฏ ุชุญุฏูุซ ุงูุฌูุณุฉ (`/users/refresh-token`)
**ุงูุทูุจ:**
```json
{
  "refreshToken": "eyJhbGci..."
}
```

**ุงูุฑุฏ:**
```json
{
  "accessToken": "eyJhbGci...",
  "token": "eyJhbGci..."  // ุงุฎุชูุงุฑู
}
```

## ูููุงุช ุชู ุฅูุดุงุคูุง/ุชุนุฏูููุง

| ุงูููู | ุงูููุน | ุงููุตู |
|------|------|--------|
| `lib/axios.js` | ุชุนุฏูู | ุชุญุณูู Interceptor ููุชุญุฏูุซ ุงูุชููุงุฆู |
| `lib/auth-debug.js` | ุฌุฏูุฏ | ุฃุฏุงุฉ ุชุตุญูุญ ูู Console |
| `lib/auth-helper.js` | ุฌุฏูุฏ | ุฏูุงู ูุณุงุนุฏุฉ ูููุตุงุฏูุฉ |
| `app/token-debug/page.js` | ุฌุฏูุฏ | ุตูุญุฉ ุงุฎุชุจุงุฑ ุงูุชููู |
| `app/contact/page.js` | ุชุนุฏูู | ุฅุถุงูุฉ ุงูุชุญูู ูู ุงูุฌูุณุฉ |
| `components/Providers.js` | ุชุนุฏูู | ุชุถููู auth-debug |

## ูุตุงุฆุญ ูููุฉ โ๏ธ

1. **ุชูุนูู Console Logging:**
   ุงูุชุญ DevTools (F12) ูุงุฎุชุฑ Tab "Console" ูุฑุคูุฉ ุฌููุน ุงูุณุฌูุงุช ุงูุชูุตูููุฉ

2. **ุงูุชุญูู ูู Network:**
   ุงุณุชุฎุฏู Tab "Network" ูู DevTools ูุฑุคูุฉ ุทูุจุงุช API ูุงูุฑุฏูุฏ

3. **ุฌุฑุจ Token Debug Page:**
   ุชู ุฅูุดุงุก ุตูุญุฉ ูุชุฎุตุตุฉ ูุงุฎุชุจุงุฑ ูู ุฌูุงูุจ ุงูุชููู ูุงูุฌูุณุฉ

4. **ุชุญูู ูู localStorage:**
   ุงูุชุจ ูู Console: `JSON.parse(localStorage.getItem('userInfo'))`

## ุงูุฎุทูุงุช ุงูุชุงููุฉ

ุฅุฐุง ุงุณุชูุฑุช ุงููุดุงูู:
1. ุชุญูู ูู ุฃู ุงูุจูุงู ุฅูุฏ ูุฑุณู `refreshToken` ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู
2. ุชุฃูุฏ ูู ุฃู endpoint ุงูุชุญุฏูุซ ููุฌูุฏ ููุนูู
3. ุงุณุชุฎุฏู ุตูุญุฉ `/token-debug` ูุงุฎุชุจุงุฑ ุดุงูู
4. ุงูุชุด Console ู Network logs ูููุฒูุฏ ูู ุงูุชูุงุตูู

---
**ุขุฎุฑ ุชุญุฏูุซ:** ุชู ุฅุถุงูุฉ ูุธุงู ุฅุตูุงุญ ุงูุชููู ูุงูุฌูุณุงุช ุงูุดุงูู
