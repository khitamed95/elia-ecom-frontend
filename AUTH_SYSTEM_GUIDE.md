# ๐ ุฏููู ุงููุธุงู ุงูุฌุฏูุฏ ูููุตุงุฏูุฉ ูุงูุชููู

## ๐ ููุฎุต ุงูุชุญุฏูุซุงุช

ุชู ุฅุถุงูุฉ ูุธุงู ุดุงูู ููุชุนุงูู ูุน ูุดุงูู ุงูุชููู ูุงูุฌูุณุงุช ุงูููุชููุฉ. ุงููุธุงู ูุชุถูู:

โ ุชุญุฏูุซ ุชููุงุฆู ููุชููู  
โ ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงููุตุงุฏูุฉ  
โ ุฃุฏูุงุช ุชุตุญูุญ ูุชุดุฎูุต  
โ ุญูุงูุฉ ุงูุตูุญุงุช  
โ Hooks ูุฎุตุตุฉ ูููุตุงุฏูุฉ  

---

## ๐๏ธ ุงูุฃุฏูุงุช ุงููุชุงุญุฉ

### 1. **ุฃุฏุงุฉ Debug ูู Console**
```javascript
window.authDebug.showTokenInfo()      // ุนุฑุถ ุงูุชููู ูุงูุฌูุณุฉ
window.authDebug.expireToken()        // ุชุนุทูู ุงูุชููู ููุงุฎุชุจุงุฑ
window.authDebug.clearAllData()       // ูุณุญ ุฌููุน ุงูุจูุงูุงุช
```

**ุงููุตูู:** ุงูุชุญ DevTools (F12) ูุงุฐูุจ ููู Console

### 2. **ุตูุญุฉ Debugging ุงููุชูุฏูุฉ**
```
http://localhost:3000/token-debug
```
ุตูุญุฉ ูุชูุฏูุฉ ูุงุฎุชุจุงุฑ:
- ุนุฑุถ ูุนูููุงุช ุงูุชููู
- ุชุนุทูู ุงูุชููู ูุงุฎุชุจุงุฑ ุงูุชุญุฏูุซ ุงูุชููุงุฆู
- ุงุฎุชุจุงุฑ API ูุญูู
- ุญุฐู ุงูุจูุงูุงุช ุจุฃูุงู

### 3. **ุฏูุงู ูุณุงุนุฏุฉ ูููุตุงุฏูุฉ**
```javascript
import { 
  isValidSession, 
  getCurrentUser, 
  getToken,
  handleAuthError 
} from '@/lib/auth-helper';

// ุงูุชุญูู ูู ูุฌูุฏ ุฌูุณุฉ ุตุญูุญุฉ
if (isValidSession()) {
  // ูุณุชุฎุฏู ูุณุฌู ุฏุฎูู
}

// ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู
const user = getCurrentUser(); // { id, email, name, role, hasToken }

// ุงูุญุตูู ุนูู ุงูุชููู
const token = getToken();

// ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงููุตุงุฏูุฉ
const error = handleAuthError(error, 'Context Name');
```

### 4. **Hook ูุฎุตุต ูููุตุงุฏูุฉ**
```javascript
import { useAuth } from '@/lib/use-auth';

export default function MyComponent() {
  const { user, isLoggedIn, token, logout } = useAuth();
  
  if (!isLoggedIn) {
    return <div>Please login</div>;
  }
  
  return <div>Welcome {user.email}</div>;
}
```

### 5. **ูููู ูุญูุงูุฉ ุงูุตูุญุงุช**
```javascript
import { ProtectRoute } from '@/lib/use-auth';

export default function AdminPage() {
  return (
    <ProtectRoute requiredRole="admin">
      <AdminContent />
    </ProtectRoute>
  );
}
```

---

## ๐ ุงููููุงุช ุงูุฌุฏูุฏุฉ ูุงููุนุฏูุฉ

### ุงููููุงุช ุงูุฌุฏูุฏุฉ:

| ุงูููู | ุงููุตู |
|------|--------|
| `lib/auth-debug.js` | ุฃุฏูุงุช ุงูุชุตุญูุญ ูู Console |
| `lib/auth-helper.js` | ุฏูุงู ูุณุงุนุฏุฉ ูููุตุงุฏูุฉ |
| `lib/use-auth.js` | Hooks ูููููุงุช ุงูุญูุงูุฉ |
| `app/token-debug/page.js` | ุตูุญุฉ ุงูุงุฎุชุจุงุฑ ุงูุดุงููุฉ |
| `TOKEN_FIX_GUIDE.md` | ุฏููู ุงูุฅุตูุงุญ ุงูุฃูู |
| `TROUBLESHOOTING_AUTH.md` | ุฏููู ุงุณุชูุดุงู ุงูุฃุฎุทุงุก |

### ุงููููุงุช ุงููุนุฏูุฉ:

| ุงูููู | ุงูุชุนุฏููุงุช |
|------|-----------|
| `lib/axios.js` | ุชุญุณูู interceptor ููุชุญุฏูุซ ุงูุชููุงุฆู |
| `app/contact/page.js` | ุฅุถุงูุฉ ุงูุชุญูู ูู ุงูุฌูุณุฉ |
| `app/admin/page.js` | ุฅุถุงูุฉ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช |
| `components/Providers.js` | ุชุถููู auth-debug |

---

## ๐ ููููุฉ ุนูู ุงูุชุญุฏูุซ ุงูุชููุงุฆู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 1. ูุฑุณู ุงููุณุชุฎุฏู ุทูุจ API                               โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ
                   โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 2. ูุชุญูู Interceptor ูู ุงูุฑุฏ                            โ
โ    - 200/201 โ ุฑุฏ ุนุงุฏู                                 โ
โ    - 401 โ๏ธ ุฌูุณุฉ ููุชููุฉ                                โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ
                   โผ
        โโโโโโโโโโโโโโโโโโโโโโโโ
        โ ูู ุงูุฑุฏ 401ุ         โ
        โโโโโโโโโโโโฌโโโโโโโโโโโโ
                   โ
        โโโโโโโโโโโโดโโโโโโโโโโโ
        โ                     โ
       ูุนู                    ูุง
        โ                     โ
        โผ                     โผ
    ุชุฌุฏูุฏ           ุฅุฑุฌุงุน ุงูุฑุฏ ุงูุนุงุฏู
    ุงูุชููู          ูููุณุชุฎุฏู
        โ
        โผ
    โ ูุฌุญุ
        โ
    โโโโโดโโโโโ
    โ        โ
   ูุนู      ูุง
    โ        โ
    โผ        โผ
  ุฅุนุงุฏุฉ    ุชูุฌูู
  ุงููุญุงููุฉ  ูููุฌู
```

---

## โ๏ธ ููููุฉ ุงูุงุณุชุฎุฏุงู ูู ุตูุญุชู

### ูุซุงู 1: ุงูุชุญูู ูู ุงูุฌูุณุฉ ูุจู ุฅุฑุณุงู ุจูุงูุงุช

```javascript
'use client';

import { isValidSession, handleAuthError } from '@/lib/auth-helper';
import api from '@/lib/axios';
import { toast } from 'react-toastify';

export default function ContactForm() {
  const handleSubmit = async (e) => {
    e.preventDefault();
    
    // ุงูุชุญูู ูู ุงูุฌูุณุฉ
    if (!isValidSession()) {
      toast.error('ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ุฃููุงู');
      window.location.href = '/login?redirect=/contact';
      return;
    }
    
    try {
      const response = await api.post('/contact', formData);
      toast.success('ุชู ุงูุฅุฑุณุงู ุจูุฌุงุญ');
    } catch (error) {
      handleAuthError(error, 'Contact Form');
    }
  };
  
  return <form onSubmit={handleSubmit}>...</form>;
}
```

### ูุซุงู 2: ุญูุงูุฉ ุตูุญุฉ ูููุณุชุฎุฏููู ููุท

```javascript
'use client';

import { useAuth } from '@/lib/use-auth';

export default function ProfilePage() {
  const { user, isLoggedIn, isLoading } = useAuth();
  
  if (isLoading) {
    return <div>ุฌุงุฑู ุงูุชุญููู...</div>;
  }
  
  if (!isLoggedIn) {
    return <div>ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู</div>;
  }
  
  return <div>ูุฑุญุจุงู {user.name}</div>;
}
```

### ูุซุงู 3: ุญูุงูุฉ ุตูุญุฉ Admin

```javascript
'use client';

import { ProtectRoute } from '@/lib/use-auth';

export default function AdminPage() {
  return (
    <ProtectRoute requiredRole="admin">
      <div>ูุญุชูู Admin ููุท</div>
    </ProtectRoute>
  );
}
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุงูุชุญุฏูุซ ุงูุชููุงุฆู:

1. ุงุฐูุจ ุฅูู `/token-debug`
2. ุงุถุบุท "ุนุฑุถ ูุนูููุงุช ุงูุชููู"
3. ุงุถุบุท "ุชุนุทูู ุงูุชููู (ููุงุฎุชุจุงุฑ)"
4. ุงุถุบุท "ุงุฎุชุจุงุฑ API ูุญูู"
5. ูุฌุจ ุฃู ูุญุฏุซ ุงูุชููู ุชููุงุฆูุงู

### ุงุฎุชุจุงุฑ Contact Form:

1. ุณุฌู ุฏุฎูู
2. ุงุฐูุจ ุฅูู `/contact`
3. ููุก ุงูุญููู ูุฅุฑุณุงู
4. ูุฌุจ ุฃู ุชุธูุฑ ุฑุณุงูุฉ ูุฌุงุญ

### ุงุฎุชุจุงุฑ ุตูุญุฉ Admin:

1. ุณุฌู ุฏุฎูู ูู admin
2. ุงุฐูุจ ุฅูู `/admin`
3. ูุฌุจ ุฃู ุชุฑู Dashboard
4. ุจุฏูู ุชุณุฌูู ุฏุฎูู โ redirect ูู `/login`

---

## ๐ ุชุตุญูุญ ุงูุฃุฎุทุงุก

### ูุดููุฉ: Token ูุง ูุชุญุฏุซ ุชููุงุฆูุงู

**ุงูุญู:**
1. ุงูุชุญ `/token-debug`
2. ุงุถุบุท "ุชุนุทูู ุงูุชููู"
3. ุงุถุบุท "ุงุฎุชุจุงุฑ API ูุญูู"
4. ุดุงูุฏ Console ููุชูุงุตูู

### ูุดููุฉ: "Cannot POST /users/refresh-token"

**ุงูุญู:**
- ุชุญูู ูู ุงูุจูุงู ุฅูุฏ ุฃู endpoint ููุฌูุฏ
- ุชุฃูุฏ ูู ุฃู ุงููุณุงุฑ `/api/users/refresh-token` ุตุญูุญ

### ูุดููุฉ: "No refresh token available"

**ุงูุญู:**
- ุชุญูู ูู ุฃู ุงูุจูุงู ุฅูุฏ ูุฑุณู `refreshToken` ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู
- ุงูุชุญ Network Tab ูุงูุธุฑ ุฅูู response ุนูุฏ ุงููุฌู

---

## ๐ ุงูููุงุฑุฏ ุงูุฅุถุงููุฉ

- **TOKEN_FIX_GUIDE.md** - ุดุฑุญ ุชูุตููู ููุฅุตูุงุญุงุช
- **TROUBLESHOOTING_AUTH.md** - ุฏููู ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ุงูุดุงูู
- **DevTools Console** - ููุฑุณุงุฆู ุงูุชูุตูููุฉ ูุงูุฃุฎุทุงุก

---

## โ ูุงุฆูุฉ ุงูุชุญูู

- [ ] ุชู ุชุซุจูุช ุฌููุน ุงููููุงุช ุงูุฌุฏูุฏุฉ
- [ ] ุชู ุชุญุฏูุซ `axios.js`
- [ ] ุชู ุชุญุฏูุซ `components/Providers.js`
- [ ] ุชู ุงุฎุชุจุงุฑ ุตูุญุฉ `/token-debug`
- [ ] ุชู ุงุฎุชุจุงุฑ Contact Form
- [ ] ุชู ุงุฎุชุจุงุฑ ุตูุญุฉ Admin
- [ ] ุชู ุงูุชุญูู ูู Console ูุนุฏู ูุฌูุฏ ุฃุฎุทุงุก

---

**ุขุฎุฑ ุชุญุฏูุซ:** ุชู ุฅุถุงูุฉ ูุธุงู ุดุงูู ูููุตุงุฏูุฉ ูุงูุชููู ูุงูุฌูุณุงุช
